1. Use atomics in critical ops
2. Simplify watchdog.
